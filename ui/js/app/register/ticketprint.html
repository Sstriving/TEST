<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=11" />
    <OBJECT classid="CLSID:8856F961-340A-11D0-A96B-00C04FD705A2" height="0" id="wb" width="0"></OBJECT>	
    <script type="text/javascript">

		var backgroundPrint = true;
		var curFieldNames=['PatientName','PatientSexName','PatientAge','PatientAgeUnitName','DeptName','ModalityName','ExamRequestTime'];
				
		function TicketPrint(data){			
			data = eval('('+data+')');
			
			curFieldNames.forEach(function(fieldName){
				SetElementContent(fieldName,eval('data.'+fieldName));
			}) 

			window.external.SetBackGroundPrint(backgroundPrint);
			
			if(!backgroundPrint){
				wb.ExecWB(6,1)
			}
		}
		
		function SetElementContent(fieldName,value){
			var ele = document.getElementById(fieldName)
			if(!ele) return;
			switch(ele.tagName){
				case 'DIV':ele.innerText=value;break;
				case 'SPAN':ele.innerText=value;break;
				case 'INPUT':ele.value=value;break;
				default:ele.innerText=value;break;
			}
		}
	</script>
</head>
<body>
	<div>
		<span style="margin-left:25px">影像科取片卡</span>
	</div>
	<div id="name">
		<span>姓名：</span><span id = "PatientName">name</span>
		<span style='margin-left:10px' id="PatientSexName">sex</span>
		<span style='margin-left:10px' id="PatientAge">age</span>
		<span style='margin-left:-5px'id="PatientAgeUnitName">unit</span>
	</div>
	<div>
		<span>申请科室：</span><span id="DeptName">department</span>
	</div>
	<div>
		<span>类型：</span><span id="ModalityName">modality</span>
		<span style='margin-left:20px'>报告/片子</span>
	</div>
	<div>
		<span id="ExamRequestTime">examRequestDate</span>
	</div>
</body>
</html>
